---
title: "Mac系わちゃわちゃ"
date: "2020-10-05"
categories: 
  - "mac"
  - "戯言"
---

どうもこんにちは、ここ数日Macの調子を直すために色々やっていたので設定画面とか色々いじりまくってわけがわからなくなっている如月翔也（[@showya\_kiss](http://twitter.com/showya_kiss)）です。  
  
　今日はここ数日のMac関係のわちゃわちゃについてお話しをしたいと思います。基本的にトラブルシュートのお話しです。

## もともとMacの調子が悪かった

　もともと最近私のMacは調子が悪かったんですよね。今年の4月くらいまでは完璧な動作をしていたんですが、いつからかGoogle Chromeを起動しながらマイクラを起動したらJavaが暴走してカックカクになったり、ネットワークに負荷がかかるとKarnel Taskが暴走してカックカクになったり、BlueStacksを起動するとKarnel Taskが暴走したり、サブディスプレイをつなぐとKarnel Taskが暴走したり、とにかく何かが暴走してアクティビティモニタでCPU%が100を超えて動きがカックカクになっていたのです。  
　とはいえ4月までと今まででは使い方は全く違いませんし、負荷を増やしたわけではないのに動作が重くなるのはなんらかの故障か問題であるのは理解できたので自分で色々試してみてはいたんです。  

## 自分の対処では直らなかった

　例えばアプリ再起動、Finder再起動やMacの再起動。セーフブートやNVRAMのクリア、SMCのクリアなんかを試していたんですが根本的な解決には至らず、再起動を挟むので一時的にKarnel Taskの暴走は収まるんですがまたすぐに発生してMacが重くなる状態が継続しており、個人的には非常にやる気が萎える状況だったのでなんとか解決したく、個人的にはMacの故障を疑っているのもあってサポートセンターに連絡して電話を貰ったのです。  

## サポートに問い合わせて問題が解消した

　サポートに問い合わせた所、一次対応者では問題は解決しなかったのですが二次対応者の対応で問題が解決しました。  
　問題箇所は特定できないんですが、新しくユーザーを作り直してそのユーザーで同じ環境を展開した所問題が発生せず問題なく使える状態になったので、ユーザー名に紐づくファイルのどれかが悪くて問題が起きているという事で納得しました。  
　内部的に使われるユーザー名なんかはわりと何でもよく、使えればどんなユーザー名でもいいので問題が解決すればそれで良いのでユーザー名は変更で良いという判断に至りました。  
　アプリケーションフォルダはそのままでユーザーを新規作成したので今までインストールしたアプリはそのままに（一部再設定・再インストールが必要なものだありました）新しいユーザーで立ち上げられたので、再インストールよりも作業としては楽な方で助かりました。  

## テストユーザーを正式ユーザーに移行するのに（ユーザー名・フォルダ名変更）

　とはいえ問題の解決のために作ったユーザーはユーザー名Test、フォルダ名Testというとんでもない適当なものだったので、流石に人に見られるのは恥ずかしいのでユーザー名・フォルダ名だけ変更する事にしました。  
　変更したいユーザー以外の管理者ユーザーでログインし、ユーザーとアカウントの項目から変更したいユーザー名をcontrolボタンを押しながらクリックして「詳細オプション」からアカウント名とホームディレクトリを両方変更してOK、それからMacを再起動してログインすればオーケーでした。  
　まあ次回同じ事をする場合「新しくユーザーを作成して試す」時には「もしそのまま通ったらそのまま使うユーザー名」で試すのを意識しておけばこの手順はいらないですし、操作が増えると言う事は問題が発生する可能性が上がるという事なので避けたほうが良いですよね。  

## SSDの空き容量が正しく表示されなく鳴ったので

　ユーザー名変更・ホームディレクトリ変更をした後再起動をかけたんですが、FinderのSSDのの残り容量とSSDを開いたときの残り容量に500GBほど差が出ており、これを放置するとSSD容量が余っているのに表示上の容量オーバーでファイルが保存できない可能性があるので簡単に調べたんですが、これはMacをセーフブートしてから再起動したら問題なく容量が合致するようになりました。  
　このあたりは困った時の一連のテンプレート対応で直る問題なので大した問題ではありませんでした。  

## マイクラのデータが壊れていたので修正

　これはMacの修正と関係あるか怪しいんですが、昨日久しぶりにマイクラのサーバーにアクセスした所マップの論理構造が破壊されていて、いつもの場所が海に差し替わっていたりネザーゲートが切れていたりしたので、とりあえずOneDriveの巻き戻し機能から1週間巻き戻したデータを拾ってきて上書きコピーしたら問題が解消していました。  
　多分なんですけどMacの不調ではなくサーバーのバージョンが上がった事でマップの書き換えが発生して大事なところが飛んだのだと思うので、バージョンアップ時には注意してみておかないと駄目だなと思います。  

## ミュージックアプリでフォルダ管理を放棄しました

　いつも苦労していたんですが、今自分の持っている音楽データが50GBくらいなんですが、これを重複させずにMacのミュージックのフォルダに保存するのが本当に難しくて、いつもフォルダ構造がおかしくなるか余計なフォルダが延々と生まれて気が狂っていたんですが、よく考えれば1TBに対して50GBなんて5パーセントなので、たった5パーセントなら二重保存になっても惜しくないので、自分の持っているデータフォルダはそのままにして「Musicを整理する」「コピーする」設定にする事にしました。これなら新しい曲を買った時にMacのミュージックフォルダから自分のデータフォルダに新しい曲をコピーするだけでいいので、そっちのほうが精神に優しいのでそうする事にしました。  

## 今は全く問題なく動いています

　とりあえずここ最近色々ありましたが、今は環境が定まっており、動かないアプリも暴走するアプリもなく無事に使えているのでいいな、と思います。  
　まあ実際に色々運用していったらそれなりの問題点が出てくるかも知れないんですが、それは個別に対処して直すなり運用でカバーするなりしていけばいいな、と思います。  
　ただ今回の反省としては運用でカバーできるからと言って我慢していると非常にストレスフルになるので良くない事と、運用でカバーすると本来サポートに聞けば直る問題なのを延々放置して我慢し続ける結果につながってしまうので、自分でとことん調べてとことん試してでも駄目な場合、運用でカバーする前に先にサポートに問い合わせた方がいいな、と思いました。  
　ユーザーを追加してそっちで試すという方法は私の中にはなかった方法ですし、FirstAidもどのタイミングで使うのが有効かがわかっていませんでしたが今回のサポートでコツを聞く事ができましたし、結果から言えば問題も解消しましたし勉強にもなったので良い経験になったと思います。  

## まとめ

　というわけでここ最近Mac関係でわちゃわちゃしていたのがだいたい収まりましたよ、というお話しでした。  
　自分でできない範囲については人に聞くのは恥ではないのでサポートをちゃんと活用できるといいね、と思います。
