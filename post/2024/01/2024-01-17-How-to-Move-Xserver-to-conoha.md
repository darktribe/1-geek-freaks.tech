---
title: "エックスサーバーからConoha WINGに乗り換える方法"
categories: 
  - "ソフト・サービス"
  - ”Webサービス”
slug: "how-to-move-from-xserver-to-conohawing"
status: publish
---
どうもこんにちは、如月翔也（[@showya_kiss](https://twitter.com/showya_kiss)）です。
　実はもうすでに移行済みなんですが、先日レンタルサーバーの速度調査においてConoha WINGが一般的なサーバーでは1位の速度である事を知り、そして今契約しているエックスサーバーがちょうど来月で契約更改の月なので、そんなに速度が出るというのであれば1年契約であればエックスサーバーより安く契約できる事もあり、思い切ってサーバーを引っ越してみたのです。
　結論から言うとサーバーは非常に高速です。かなり満足できる速度でサイトが表示されます。
　しかしエックスサーバーからConoha WINGに引っ越そうとするとかなり苦労したので、正しい方法で引っ越すには何が必要かについて記録を残しておこうと思います。

## 現時点のConoha WINGの評価について
　まだ引っ越して3日目ですが、Conoha WINGについてはこういう評価をしています。

- サーバーは間違いなく高速。速度の点では文句がない。
- 電話サポートの品質はちょっと低い。質問に即答できずにメール回答になった。
- メールサポートの品質はクソ。対応がありえない。正直初心者にはお勧めできない。
- 「簡単無料SSL」でLet's Encryptを使っているが、同じく無料で使えるアルファSSLの方が使いやすい。
- コントロールパネルはエックスサーバーと違って一元化で利用できるが読み込みが重すぎる。
- 正直ある程度自分で調べながらできる人ないとサーバー移行は難しいと思う。
- 初めてWordPressを持つなら悪くはないような気もする。

　こんな感じです。
　正直賛否分かれるというか、サポートは良くないですし導線も良くなく、そしてシステムが結構クソな作りをしているので良く言えば将来性が見込める、悪く言えば現段階で初心者が手を出せるレベルにない感じがします。
　ただ、僕は速度については本当に満足していて、そしてLet's EncryptのオレオレSSLではなく有料展開しているアルファSSLが無料で使えるという点を評価して、とりあえず1年ガッツリ使ってみようと思っています。

## 他レンタルサーバーからConoha WINGに引っ越す時の注意点について
　とりあえず今回移行で痛い目にあったのは、Conoha WINGに限らないんですが、無料SSLでLet's Encryptを使っているサービス全てに言えるのですが、Let's Encryptの制限として、以下があります。

- 1ドメインについて週に50通しかSSL証明書を出せない。これはサブドメインも同じドメインにカウントする。
- 1ドメインについて週に5回以上失敗すると1週間再チャレンジできなくなる。これはサブドメインも同じドメインにカウントする。
- ドメインの有効期間が切れている、または有効期間切れが近いと証明書が発行できない。これはドメイン移管中も同じで、ドメイン移管を処理している間はSSL証明書が発行できない。
- ドメインは「wwwなしドメイン」と「wwwありドメイン」の両方のネームサーバーがConoha WINGのネームサーバーを指していないと証明書が発行できない。
- ドメインは「wwwなしドメイン」と「wwwありドメイン」の両方がConoha WINGのサーバーIPを指していないと証明書が発行できない。

　これ、ちょっと注意が必要なんですが、まずConoha WINGを申し込んでドメイン無料でドメインを移管した場合、移管作業が始まってから終わるまではLet's EncryptでSSLが発行できないので、移管作業が終わるまで「https」での接続ができなくなります。致命的です。
　あと、作業方法は後で丁寧に説明しますが、トライアンドエラーで設定すると「1ドメインで5回失敗」をあっという間に達成してそこから1週間再申請が全部蹴られて、結果「https」で接続できなくなります。最悪です。

　ただ、これには回避策があって、Let's Encryptにこだわらなければ、Conoha WINGを使っている間は「GMO」さんの「アルファSSL」が無制限かつ無料で申し込めて、これはドメイン移管中でも申請ができますし、失敗カウントはしませんし、まあネームサーバーとIPアドレスはConoha WINGを指していないと駄目なんですが、Let's EncryptはオレオレSSLなのでちょっと信頼性が低く、それに比べるとアルファSSLは一応会社認証のSSLなので信頼性がちょっと高く（SSLというシステムの信頼性じゃなくて、「この証明書を使っているなら信頼できるかもな」的な、ちょっとマニアックな観点からの信頼性です）、まあ無料で使えて制限が少ないのであればそっちを使った方が圧倒的に良いです。

## 具体的なエックスサーバーからConoha WINGへの引っ越し手順
　では具体的に、エックスサーバーからConoha WINGへ引っ越しをする手順について説明します。
　ドメイン移管は別に後でしてもいいので、ドメイン移管はなしで説明します。あくまで現在エックスサーバーのDNSとレンタルサーバーを使って運営している人が、Conoha WINGに引っ越す手順について説明します。
　具体的にと言うか、何をどうするためにこの作業をしているのか説明しないと意味がわからない事になるので、手順について簡単に説明します。

- Conoha WINGの「サーバー管理」から「ドメイン」を選んで追加したいドメインを追加する
　Conoha WINGで今使っているドメインを使いたい場合、「ドメイン」メニューではなく「サーバー管理」から追加する必要があります。「ドメイン」メニューを開くとドメイン取得か移管の作業に移動してしまうので、「サーバー管理」から行きます。
- Conoha WINGの「サイト管理」から「サイト設定」を選んでWordPressの「＋」を押して「かんたん移行」を使ってWordPressをコピーする
　WordPressの引っ越しをするので、「かんたん移行」でWordPressをコピーすると楽です。「テスト移行」を使うと後で面倒くさいので、いきなり本番環境で行きます。
- エックスサーバーのDNSに、引っ越したいドメイン（wwwありドメインとwwwなしドメイン）のネームサーバーをConohaを指すように設定する。その後Conoha WINGのDNS設定でエックスサーバーのIPを設定する
　Conoha WINGでSSLを使うには、「wwwありドメイン」と「wwwなしドメイン」のネームサーバーがConoha WINGのネームサーバーを指していないといけないので、まずその設定を行います。
　ネームサーバーが切り替わった瞬間名前解決ができなくなる恐れがあるので、同時にConoha WINGのDNSにエックスサーバーのIPアドレスを入力しておきます。
- ネームサーバーの変更が確認できたらエックスサーバーとConoha WINGのDNSにConoha WINGのIPアドレスを設定する
　ネームサーバーの変更が確認できたら、もうWordPressはコピーしているので、コピーしたWordPressを指すようにDNSに対してIPアドレスを設定します。
- IPアドレスの変更が確認できたら、Conoha WINGのオプション独自SSLでアルファSSLを設定する
　IPアドレスが変更されたら、その瞬間からSSL接続ができなくなるので、大急ぎでアルファSSLを設定します。
- 引っ越し完了を確認する

　ちょっと面倒なんですが、この手順で行わないとSSLの設定で手間取って「SSLで接続できない」時間が長くなったり、あるいはIPアドレスが正しいものを指さなくてサーバーが切り替わらなくて新規投稿ができない結果になるので、この手順が重要です。
　では、手順について、段階を踏んで個々に説明していきます。

### Conoha WINGの「サーバー管理」から「ドメイン」を選んで追加したいドメインを追加する
　まず、エックスサーバーで持っているドメインをConoha WINGに設定する必要があります。
　[Conohaのログインページ](https://www.conoha.jp/login/)からログインしてダッシュボードに入ります。
　画面上に「WING」という項目があるのでそこをクリックすると画面が切り替わり、左下に「サーバー管理」のメニューがあるのでクリックし、中画面「ドメイン」をクリックすると右画面に「＋ドメイン」というボタンがあるのでクリックします。
　ドメイン入力画面が開くので、「ドメイン追加」を選んでドメイン名を入力し、「無料独自SSL」は「利用しない」で「保存」を押すとドメインが保存されます。
　サブドメインを使いたい場合、メインのドメインを一回保存した上で、「サブドメインを追加」からサブドメインを入力して「ドメインを選択」して保存すればオーケーです。「無料独自SSL」は「利用しない」で選んで下さい。

### Conoha WINGの「サイト管理」から「サイト設定」を選んでWordPressの「＋」を押して「かんたん移行」を使ってWordPressをコピーする
　次に、作ったサイトでWordPressをコピーします。
　Conohaのダッシュボードで画面上に「WING」という項目があるのでそこをクリックすると画面が切り替わり、右下に「サイト管理」というメニューがあるのでクリックし、中画面が操作したいドメインになっていなければ「切り替え」ボタンを押すと右画面がドメインリストになっているので操作したいドメインをクリックすると中画面のドメイン名が選んだものになり、そのすぐ下に「サイト管理」というメニューがあるのでそれをクリックすると、画面右に「＋WordPress」というボタンがあるので押します。
　右画面が切り替わり、インストール方法などが聞かれるので、次の設定を行います。
- 「インストール方法」：「かんたん移行」
- 「テスト移行」：「利用しない」
- 「バージョン」：選べないのでそのまま
- 「移行元URL」：移行したい元のURLを入力
- 「サイトURL」：「wwwあり」「wwwなし」を好きに選択。「wwwなし」を選んだ場合、「wwwあり」で接続すると「wwwなし」にリダイレクトされる設定になります。
- 「移行元ユーザー名」：元のURLで管理画面に入るためのユーザー名を入力
- 「移行元パスワード」：元のURLで管理画面に入るためのパスワードを入力
- 「データベース」：データベース名・ユーザー名・パスワードは任意で入力。
- 「コントロールパネルプラグイン」：「インストールする」にチェック
- 「自動キャッシュクリアプラグイン」：「インストールする」にチェック

　この設定をした上で画面下の「保存」を押すとWordPressのコピーが始まります。
　無事に終わるまで待ちましょう。

### エックスサーバーのDNSに、引っ越したいドメイン（wwwありドメインとwwwなしドメイン）のネームサーバーをConohaを指すように設定する。その後Conoha WINGのDNS設定でエックスサーバーのIPを設定する
　WordPressのコピーが終わるまで待たなくていいんですが、エックスサーバーのDNSに、引っ越したいドメインのネームサーバーを設定します。
　この時注意してほしいんですが、「wwwなし」だけで保存すると、「wwwあり」のネームサーバーの反映が遅れて結果的にサイト引っ越しが遅れる恐れがあるので、「wwwあり」と「wwwなし」のネームサーバーをエックスサーバーのDNSに設定する必要があります。

　[XServerレンタルサーバーログイン画面](https://secure.xserver.ne.jp/xapanel/login/xserver/)からログインし、「サーバー管理」をクリックしてサーバーパネルを開きます。
　「ドメイン」の中にある「DNSレコード設定」をクリックして画面を切り替え、変更するドメイン名をクリックします。
　切り替わった画面、「DNSレコード一覧」をクリックすると、種別が「NS」になっている項目が5つあると思います。このうち3個を書き換えて、残り2個は削除します。
　おそらく「wwwなし」のドメインしかないので、その後で「wwwあり」のドメインを設定し、「NS」ドメインを3つ追加します。

- 種別が「NS」、値が「ns1.xserver.jp」の項目を「変更」し、切り替わった画面で「内容」を「ns-a1.conoha.io」に書き換えて「確認画面に進む」をクリック、切り替わった画面で「変更する」をクリックする。終わったら「DNSレコード一覧」をクリックする。
- 種別が「NS」、値が「ns2.xserver.jp」の項目を「変更」し、切り替わった画面で「内容」を「ns-a2.conoha.io」に書き換えて「確認画面に進む」をクリック、切り替わった画面で「変更する」をクリックする。終わったら「DNSレコード一覧」をクリックする。
- 種別が「NS」、値が「ns3.xserver.jp」の項目を「変更」し、切り替わった画面で「内容」を「ns-a3.conoha.io」に書き換えて「確認画面に進む」をクリック、切り替わった画面で「変更する」をクリックする。終わったら「DNSレコード一覧」をクリックする。
- 種別が「NS」、値が「ns4.xserver.jp」の項目を「削除」し、切り替わった画面で「削除する」をクリックする。終わったら「DNSレコード一覧」をクリックする。
- 種別が「NS」、値が「ns5.xserver.jp」の項目を「削除」し、切り替わった画面で「削除する」をクリックする。終わったら「DNSレコード一覧」をクリックする。

　つづいて「wwwあり」のネームサーバーも登録していきます。

- 「DNSレコード追加」を選択して画面を切り替え、「ホスト名」に「wwwありドメイン」を入力、「種別」を「NS」にして「内容」に「ns-a1.conoha.io」を入れて「確認画面に進む」をクリック、切り替わった画面で「追加する」をクリック。終わったら「DNSレコード追加」をクリックする。
- 「DNSレコード追加」を選択して画面を切り替え、「ホスト名」に「wwwありドメイン」を入力、「種別」を「NS」にして「内容」に「ns-a2.conoha.io」を入れて「確認画面に進む」をクリック、切り替わった画面で「追加する」をクリック。終わったら「DNSレコード追加」をクリックする。
- 「DNSレコード追加」を選択して画面を切り替え、「ホスト名」に「wwwありドメイン」を入力、「種別」を「NS」にして「内容」に「ns-a3.conoha.io」を入れて「確認画面に進む」をクリック、切り替わった画面で「追加する」をクリック。

　これでネームサーバーの変更が完了しました。ネームサーバーの変更と同時に名前解決ができなくなる恐れがあるので、Conoha WINGのDNSに一時的にエックスサーバーのIPアドレスを入力しておきます。
　[Conohaのログインページ](https://www.conoha.jp/login/)からログインしてダッシュボードに入ります。
　画面上に「WING」という項目があるのでそこをクリックすると画面が切り替わり、左下に「DNS」のメニューがあるのでクリックし、右画面にドメインリストがあるので変更するドメイン名をクリックすると設定画面が展開します。
　登録したドメインにConoha WINGのIPアドレスが入っているのですが、ドメイン横に鉛筆マークがあるのでクリックして設定を書き換え可能にして、「wwwなしドメイン名」の「値」をエックスサーバーで使っていたIPアドレスに書き換えます。また、「wwwありドメイン名」の「値」もエックスサーバーで使っていたIPアドレスに書き換えます。また「＠」という項目もあるので、それもエックスサーバーで使っていたIPアドレスに書き換えます。書き換えたら画面右下の「保存」を押せばオーケーです。

　なお、エックスサーバーで使っていたIPアドレスが分からない場合、[XServerレンタルサーバーログイン画面](https://secure.xserver.ne.jp/xapanel/login/xserver/)からログインし、「サーバー管理」をクリックしてサーバーパネルを開き、そこから「サーバー情報」を開くと「IPアドレス」の場所にエックスサーバーで使っているIPアドレスが書いてありますので参照して下さい。

### ネームサーバーの変更が確認できたらエックスサーバーとConoha WINGのDNSにConoha WINGのIPアドレスを設定する
　次の作業はちょっと専門スキルが必要です。基本的にはWindowsでもMacでも同じ方法で確認できるので、まず、ネームサーバーが反映されるかを監視します。

- Windowsの場合のネームサーバーの監視方法
　Windowsキー＋Rを推して「ファイル名を指定して実行」を開き、「cmd」と入れてエンターします。
　コマンドプロンプトが開くので、まず「nslookup」と入力してリターンします。その後「set type=ns」と入力してリターンします。最後に「ドメイン名」を入力します。
　この結果、「ns1.xserver.jp」と帰ってきたらまだ反映されていません。時間をおいてまた「ドメイン名」を入力して下さい。「ns-a1.conoha.io」と帰ってきた場合、ネームサーバーの変更が完了しています。一応「wwwありドメイン名」を入力して、それも「ns-a1.conoha.io」と帰ってきた場合完全にネームサーバーが変更されているので「exit」と入力してエンターした後コマンドプロンプトを閉じて次の作業に戻ります。

- Macの場合のネームサーバーの監視方法
　Finderから「アプリケーション」「ユーティリティ」を経由して「ターミナル」を起動します。
　ターミナルが開くので、まず「nslookup」と入力してリターンします。その後「set type=ns」と入力してリターンします。最後に「ドメイン名」を入力します。
　この結果、「ns1.xserver.jp」と帰ってきたらまだ反映されていません。時間をおいてまた「ドメイン名」を入力して下さい。「ns-a1.conoha.io」と帰ってきた場合、ネームサーバーの変更が完了しています。一応「wwwありドメイン名」を入力して、それも「ns-a1.conoha.io」と帰ってきた場合完全にネームサーバーが変更されているので「exit」と入力してエンターした後ターミナルを閉じて次の作業に戻ります。

　この時点でほぼ確実にConoha WINGのDNSだけ変更すれば大丈夫なんですが、時間差なんかで名前解決ができなくなると困るので、Conoha WINGのDNSとエックスサーバーのDNSにConoha WINGのIPアドレスを登録します。　
　Conoha WINGのIPアドレスの調べ方は[Conohaのログインページ](https://www.conoha.jp/login/)からログインしてダッシュボードに入ります。画面上の「WING」をクリックしてから画面左の「サーバー管理」をクリックして切り替わった中画面の「契約情報」をクリックし、「サーバー情報」を開くと下の方の「スペック」の中に「IPアドレス」があるので、その値がConoha WINGのIPアドレスです。

- Conoha WINGのIPアドレスを変更する
　[Conohaのログインページ](https://www.conoha.jp/login/)からログインしてダッシュボードに入ります。
　画面上に「WING」という項目があるのでそこをクリックすると画面が切り替わり、左下に「DNS」のメニューがあるのでクリックし、右画面にドメインリストがあるので変更するドメイン名をクリックすると設定画面が展開します。
　登録したドメイン（wwwあり、wwwなし、＠）にさっき入力したエックスサーバーのIPアドレスが入っているのですが、ドメイン横に鉛筆マークがあるのでクリックして設定を書き換え可能にして、「wwwなしドメイン名」「wwwありドメイン名」「＠」の項目について、「値」をConoha WINGのIPアドレスに書き換えます。書き換えたら画面右下の「保存」を押せばオーケーです。

- エックスサーバーのIPアドレスを変更する
　[XServerレンタルサーバーログイン画面](https://secure.xserver.ne.jp/xapanel/login/xserver/)からログインし、「サーバー管理」をクリックしてサーバーパネルを開きます。
　「ドメイン」の中にある「DNSレコード設定」をクリックして画面を切り替え、変更するドメイン名をクリックします。
　切り替わった画面、「DNSレコード一覧」をクリックすると、「wwwありドメイン」と「wwwなしドメイン」と「＊」の「種別」が「A」になっている項目があるので、一つずつ「変更」して「内容」をConoha WINGのIPに書き換え、「確認画面に進む」をクリックして切り替わった画面で「変更する」をクリックし、そしてDNSレコード一覧に戻るを繰り返します。
　これで「wwwありドメイン」と「wwwなしドメイン」と「＊」が書き換えられればこの手順は終了です。

### IPアドレスの変更が確認できたら、Conoha WINGのオプション独自SSLでアルファSSLを設定する
　次の作業はちょっと専門スキルが必要です。基本的にはWindowsでもMacでも同じ方法で確認できるので、まず、IPアドレスが反映されるかを監視します。

- Windowsの場合のIPアドレスの監視方法
　Windowsキー＋Rを推して「ファイル名を指定して実行」を開き、「cmd」と入れてエンターします。
　コマンドプロンプトが開くので、まず「nslookup ドメイン名」と入力してリターンします。
　この結果、エックスサーバーのIPアドレスが帰ってきたらまだ反映されていません。時間をおいてまた「nslookup ドメイン名」を入力して下さい。Conoha WINGのIPアドレス帰ってきた場合、IPの変更が完了しています。一応「nslookup wwwありドメイン名」を入力して、それもConoha WINGのIPアドレス帰ってきた場合完全にネームサーバーが変更されているのでコマンドプロンプトを閉じて次の作業に戻ります。

- Macの場合のIPアドレスの監視方法
　Finderから「アプリケーション」「ユーティリティ」を経由して「ターミナル」を起動します。
　ターミナルが開くので、まず「nslookup ドメイン名」と入力してリターンします。
　この結果、エックスサーバーのIPアドレスが帰ってきたらまだ反映されていません。時間をおいてまた「nslookup ドメイン名」を入力して下さい。Conoha WINGのIPアドレス帰ってきた場合、IPの変更が完了しています。一応「nslookup wwwありドメイン名」を入力して、それもConoha WINGのIPアドレス帰ってきた場合完全にネームサーバーが変更されているのでターミナルを閉じて次の作業に戻ります。

　IPアドレスが反映したら、最後の作業はConoha WINGを使って引っ越したドメインとWordPressにアルファSSLを適用する事です。
　この作業をする前はドメイン名で接続しようとすると「https」では接続できず、「http」でしか接続できませんが、アルファSSLを設定すれば再びSSLで接続できるようになります。
　[Conohaのログインページ](https://www.conoha.jp/login/)からログインしてダッシュボードに入ります。
　画面上に「WING」という項目があるのでそこをクリックすると画面が切り替わり、左下に「サイト管理」のメニューがあるのでクリックし、中画面に使うドメインが入っていない場合中画面「切り替え」を選ぶとドメインリストが表示されるので使うドメインの横にある「切り替え」で画面を切り替えます。
　使うドメインが入っている場合、画面中の「サイトセキュリティ」を選択すると画面右が切り替わるので、「オプション独自SSL」を開き、「オプション独自SSL」ボタンがあるのでそれを押すと設定画面が開きます。
　変更する設定は特にないので「次へ」を押すと「設定完了までお待ち下さい」の画面が表示されます。
　ここまで確実に作業していれば失敗はしないので、5～10分待って下さい。もしかしたらその前に設定画面に「完了」が出るかも知れません。
　10分ほど待って、まだ「完了」が出なければ、自サイトにhttpsで接続してみて下さい。何回アクセスしてもhttpsで接続できない場合、「CTRL+SHIFT+R」キーでスーパーリロードすると読み込めるようになりかも知れません。

### 引っ越し完了を確認する
　これで最終的にSSLで接続ができればサイト引っ越しは終了です。
　文章にすると1万文字くらいのとんでもない手間になるんですが、慣れれば一連の作業を待ち時間抜きで5分くらいで作業できるので、いくつかサイトがあっても結構簡単に引っ越しができると思います。

　というわけで長々とおつきあいいただきありがとうございました！